import{u as e,d as t,_ as s,f as n,c as o,b as m}from"./index.654db5b3.js";import{_ as a,u as l,r}from"./TextareaGrow.9d999fd6.js";import{o as d,c as i,e as c,j as u,v as p,q as h,b,O as v,p as f,a as g,F as C,f as y,w as $,t as _,i as F}from"./vendor.2c14fa92.js";const R={name:"CommentMessage",components:{TextareaGrow:a},inject:["handleCommentsUpdate"],props:{parentId:{type:[String,null],default:null}},emits:["send"],setup:()=>({v$:l()}),data:()=>({name:"",message:""}),computed:{isDisabled(){return this.v$.$invalid},uid:()=>e(),labelForAuthor(){return`author-${this.uid}`},labelForMessage(){return`message-${this.uid}`}},validations:()=>({name:{required:r},message:{required:r}}),mounted(){this.parentId&&this.$refs.inputName.focus()},methods:{handleSubmit(){if(this.v$.$touch(),this.v$.$invalid)return;const s={slug:this.$route.params.slug,comment:{name:this.name,text:this.message,date:Date.now(),id:e(),children:[]}};this.parentId&&(s.parentId=this.parentId);const n=t(s);this.handleCommentsUpdate(n),this.name="",this.message="",this.v$.$reset(),this.$emit("send")}}},S={class:"form-group"},w={class:"form-group"};R.render=function(e,t,s,n,o,m){const a=b("TextareaGrow");return d(),i("form",{action:"#0",onSubmit:t[3]||(t[3]=h(((...e)=>m.handleSubmit&&m.handleSubmit(...e)),["prevent"]))},[c("div",S,[c("label",{for:m.labelForAuthor},"Author",8,["for"]),u(c("input",{id:m.labelForAuthor,ref:"inputName","onUpdate:modelValue":t[1]||(t[1]=e=>o.name=e),class:["form-control",{"is-invalid":e.v$.name.$error}],type:"text",placeholder:"author"},null,10,["id"]),[[p,o.name]])]),c("div",w,[c("label",{for:m.labelForMessage},"Message",8,["for"]),c(a,{id:m.labelForMessage,modelValue:o.message,"onUpdate:modelValue":t[2]||(t[2]=e=>o.message=e),class:["form-control",{"is-invalid":e.v$.message.$error}],"max-height":350,placeholder:"message"},null,8,["id","modelValue","class"])]),c("button",{class:"btn btn--primary",disabled:m.isDisabled}," Send ",8,["disabled"])],32)};const x={name:"CommentReplies",components:{Comment:v((()=>s((()=>Promise.resolve().then((function(){return N}))),void 0)))},props:{replies:{type:Array,default:()=>[]}}},I=$();f("data-v-5b9cde36");const j={class:"comment-replies"};g();const k=I(((e,t,s,n,o,m)=>{const a=b("Comment");return d(),i("div",j,[(d(!0),i(C,null,y(s.replies,(e=>(d(),i(a,{key:e.id,comment:e},null,8,["comment"])))),128))])}));x.render=k,x.__scopeId="data-v-5b9cde36";const U={name:"Comment",components:{CommentForm:R,CommentReplies:x},inject:["handleCommentsUpdate"],props:{comment:{type:[Object,null],default:null},parent:{type:[Object,null],default:null}},data:()=>({showReplyForm:!1}),computed:{date(){return this.$timeAgo(this.comment.date)},replies(){var e;return null==(e=this.comment)?void 0:e.children}},methods:{handleRemove(){const e=n(this.$route.params.slug,this.comment.id);this.handleCommentsUpdate(e)},handleSend(){this.showReplyForm=!1}}},A=$();f("data-v-53bc1ef9");const M={class:"comment-container"},T={class:"comment"},L={class:"comment-header"},O={class:"comment-name"},V={class:"comment-date"},D={class:"comment-body"},q={class:"comment-footer"},E={key:0,class:"comment-reply"};g();const G=A(((e,t,s,n,o,m)=>{const a=b("CommentForm"),l=b("CommentReplies");return d(),i("div",M,[c("article",T,[c("header",L,[c("div",O,_(s.comment.name),1),c("div",V,_(m.date),1)]),c("div",D,_(s.comment.text),1),c("footer",q,[c("button",{class:"btn btn--link",onClick:t[1]||(t[1]=e=>o.showReplyForm=!o.showReplyForm)}," Reply "),c("button",{class:"btn btn--link",onClick:t[2]||(t[2]=(...e)=>m.handleRemove&&m.handleRemove(...e))}," Remove ")])]),o.showReplyForm?(d(),i("div",E,[c(a,{"parent-id":s.comment.id,onSend:m.handleSend},null,8,["parent-id","onSend"])])):F("",!0),m.replies.length?(d(),i(l,{key:1,replies:m.replies,comment:s.comment},null,8,["replies","comment"])):F("",!0)])}));U.render=G,U.__scopeId="data-v-53bc1ef9";var N=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:U});const P={name:"Comments",components:{CommentForm:R,Comment:U},provide(){return{handleCommentsUpdate:this.handleCommentsUpdate}},props:{postComments:{type:Array,default:()=>[]}},data(){return{comments:this.postComments}},computed:{commentsLength(){return o(this.comments)},hasComments(){return Boolean(this.commentsLength)}},methods:{handleCommentsUpdate(e){this.comments=e}}},H=$();f("data-v-2aec7806");const z={class:"comments"},B={class:"comments-count"},J={key:0,class:"comments-list"};g();const K=H(((e,t,s,n,o,m)=>{const a=b("CommentForm"),l=b("Comment");return d(),i("div",z,[c("h3",B," Comments: "+_(m.commentsLength),1),c(a,{class:"comments-form"}),m.hasComments?(d(),i("div",J,[(d(!0),i(C,null,y(o.comments,(e=>(d(),i(l,{key:e.id,comment:e},null,8,["comment"])))),128))])):F("",!0)])}));P.render=K,P.__scopeId="data-v-2aec7806";const Q={name:"Post",components:{Comments:P},beforeRouteEnter(e,t,s){const{slug:n}=e.params;m(n)?s():s({name:"NotFound"})},data:()=>({post:null}),created(){const e=this.$route.params.slug,t=m(e);this.post=t}},W=$();f("data-v-34bbd56e");const X={class:"post"},Y=c("hr",null,null,-1);g();const Z=W(((e,t,s,n,o,m)=>{const a=b("Comments");return d(),i("div",X,[c("h1",null,_(o.post.title),1),c("div",{class:"post__body",innerHTML:o.post.text},null,8,["innerHTML"]),Y,c(a,{"post-comments":o.post.comments},null,8,["post-comments"])])}));Q.render=Z,Q.__scopeId="data-v-34bbd56e";export default Q;
