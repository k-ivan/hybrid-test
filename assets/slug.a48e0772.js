import{u as e,d as t,_ as s,f as n,h as o,c as m,b as a}from"./index.3276c220.js";import{u as r,r as l}from"./index.esm.8bb599b9.js";import{_ as d}from"./TextareaGrow.ceec360d.js";import{o as i,c,e as u,g as p,v as h,n as b,d as v,O as f,p as g,a as C,F as y,h as $,w as _,t as F,b as R}from"./vendor.b1a999a8.js";const S={name:"CommentMessage",components:{TextareaGrow:d},inject:["handleCommentsUpdate"],props:{parentId:{type:[String,null],default:null}},emits:["send"],setup:()=>({v$:r()}),data:()=>({name:"",message:""}),computed:{isDisabled(){return this.v$.$invalid},uid:()=>e(),labelForAuthor(){return`author-${this.uid}`},labelForMessage(){return`message-${this.uid}`}},validations:()=>({name:{required:l},message:{required:l}}),mounted(){this.parentId&&this.$refs.inputName.focus()},methods:{handleSubmit(){if(this.v$.$touch(),this.v$.$invalid)return;const s={slug:this.$route.params.slug,comment:{name:this.name,text:this.message,date:Date.now(),id:e(),children:[]}};this.parentId&&(s.parentId=this.parentId);const n=t(s);this.handleCommentsUpdate(n),this.name="",this.message="",this.v$.$reset(),this.$emit("send")}}},x={class:"form-group"},A={class:"form-group"};S.render=function(e,t,s,n,o,m){const a=v("TextareaGrow");return i(),c("form",{action:"#0",onSubmit:t[3]||(t[3]=b(((...e)=>m.handleSubmit&&m.handleSubmit(...e)),["prevent"]))},[u("div",x,[u("label",{for:m.labelForAuthor},"Author",8,["for"]),p(u("input",{id:m.labelForAuthor,ref:"inputName","onUpdate:modelValue":t[1]||(t[1]=e=>o.name=e),class:["form-control",{"is-invalid":e.v$.name.$error}],type:"text",placeholder:"author"},null,10,["id"]),[[h,o.name]])]),u("div",A,[u("label",{for:m.labelForMessage},"Message",8,["for"]),u(a,{id:m.labelForMessage,modelValue:o.message,"onUpdate:modelValue":t[2]||(t[2]=e=>o.message=e),class:["form-control",{"is-invalid":e.v$.message.$error}],"max-height":350,placeholder:"message"},null,8,["id","modelValue","class"])]),u("button",{class:"btn btn--primary",disabled:m.isDisabled}," Send ",8,["disabled"])],32)};const k={name:"CommentReplies",components:{Comment:f((()=>s((()=>Promise.resolve().then((function(){return q}))),void 0)))},props:{replies:{type:Array,default:()=>[]}}},w=_();g("data-v-5b9cde36");const I={class:"comment-replies"};C();const j=w(((e,t,s,n,o,m)=>{const a=v("Comment");return i(),c("div",I,[(i(!0),c(y,null,$(s.replies,(e=>(i(),c(a,{key:e.id,comment:e},null,8,["comment"])))),128))])}));k.render=j,k.__scopeId="data-v-5b9cde36";const U={name:"Comment",components:{CommentForm:S,CommentReplies:k},inject:["handleCommentsUpdate"],props:{comment:{type:[Object,null],default:null},parent:{type:[Object,null],default:null}},data:()=>({showReplyForm:!1}),computed:{isAdmin:()=>n.isAdmin,date(){return this.$timeAgo(this.comment.date)},replies(){var e;return null==(e=this.comment)?void 0:e.children}},methods:{handleRemove(){const e=o(this.$route.params.slug,this.comment.id);this.handleCommentsUpdate(e)},handleSend(){this.showReplyForm=!1}}},M=_();g("data-v-2c496217");const T={class:"comment-container"},L={class:"comment"},O={class:"comment-header"},V={class:"comment-name"},D={class:"comment-date"},E={class:"comment-body"},G={class:"comment-footer"},N={key:0,class:"comment-reply"};C();const P=M(((e,t,s,n,o,m)=>{const a=v("CommentForm"),r=v("CommentReplies");return i(),c("div",T,[u("article",L,[u("header",O,[u("div",V,F(s.comment.name),1),u("div",D,F(m.date),1)]),u("div",E,F(s.comment.text),1),u("footer",G,[u("button",{class:"btn btn--link",onClick:t[1]||(t[1]=e=>o.showReplyForm=!o.showReplyForm)}," Reply "),m.isAdmin?(i(),c("button",{key:0,class:"btn btn--link",onClick:t[2]||(t[2]=(...e)=>m.handleRemove&&m.handleRemove(...e))}," Remove ")):R("",!0)])]),o.showReplyForm?(i(),c("div",N,[u(a,{"parent-id":s.comment.id,onSend:m.handleSend},null,8,["parent-id","onSend"])])):R("",!0),m.replies.length?(i(),c(r,{key:1,replies:m.replies,comment:s.comment},null,8,["replies","comment"])):R("",!0)])}));U.render=P,U.__scopeId="data-v-2c496217";var q=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:U});const H={name:"Comments",components:{CommentForm:S,Comment:U},provide(){return{handleCommentsUpdate:this.handleCommentsUpdate}},props:{postComments:{type:Array,default:()=>[]}},data(){return{comments:this.postComments}},computed:{commentsLength(){return m(this.comments)},hasComments(){return Boolean(this.commentsLength)}},methods:{handleCommentsUpdate(e){this.comments=e}}},z=_();g("data-v-2aec7806");const B={class:"comments"},J={class:"comments-count"},K={key:0,class:"comments-list"};C();const Q=z(((e,t,s,n,o,m)=>{const a=v("CommentForm"),r=v("Comment");return i(),c("div",B,[u("h3",J," Comments: "+F(m.commentsLength),1),u(a,{class:"comments-form"}),m.hasComments?(i(),c("div",K,[(i(!0),c(y,null,$(o.comments,(e=>(i(),c(r,{key:e.id,comment:e},null,8,["comment"])))),128))])):R("",!0)])}));H.render=Q,H.__scopeId="data-v-2aec7806";const W={name:"Post",components:{Comments:H},beforeRouteEnter(e,t,s){const{slug:n}=e.params;a(n)?s():s({name:"NotFound"})},data:()=>({post:null}),created(){const e=this.$route.params.slug,t=a(e);this.post=t}},X=_();g("data-v-34bbd56e");const Y={class:"post"},Z=u("hr",null,null,-1);C();const ee=X(((e,t,s,n,o,m)=>{const a=v("Comments");return i(),c("div",Y,[u("h1",null,F(o.post.title),1),u("div",{class:"post__body",innerHTML:o.post.text},null,8,["innerHTML"]),Z,u(a,{"post-comments":o.post.comments},null,8,["post-comments"])])}));W.render=ee,W.__scopeId="data-v-34bbd56e";export default W;
